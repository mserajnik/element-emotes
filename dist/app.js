function Ku(u,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const D in s)if(D!=="default"&&!(D in u)){const r=Object.getOwnPropertyDescriptor(s,D);r&&Object.defineProperty(u,D,r.get?r:{enumerable:!0,get:()=>s[D]})}}}return Object.freeze(Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}))}/*!
 * element-emotes
 * Copyright (C) 2022-present  Michael Serajnik  https://github.com/mserajnik
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */const Ce=(u,e)=>`${u}?accessKey=${e}`,Ee={fetchEmotes:async()=>{let u=await fetch(Ce(g.get("emotesUrl"),g.get("accessKey")));if(!u.ok){const e=new Error(`HTTP status code: ${u.status}`);throw e.response=u,e.status=u.status,e}return u=await u.json(),u.emotes}};/*!
 * element-emotes
 * Copyright (C) 2022-present  Michael Serajnik  https://github.com/mserajnik
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */let Au=!1;const G={emotesUrl:null,accessKey:null,defaultEmoteSize:"2em",largeEmoteSize:"4em",useFrozenEmotes:!1,emoteSuggestionAmount:10,useEmoteFuzzyMatching:!0,emoteFuzzyMatchingLocation:0,emoteFuzzyMatchingDistance:100,emoteFuzzyMatchingThreshold:.6,emoteSuggestionBlacklistedStrings:"",usernameColors:["","","","","","","",""],emotes:[]},g={initialize:()=>new Promise((u,e)=>{chrome.storage.sync.get(null,async n=>{if(chrome.runtime.lastError)return e(new Error("Error while intializing the store."));for(const s in n)Object.hasOwn(G,s)&&(G[s]=n[s]);Au=!0;try{G.emotes=await Ee.fetchEmotes()}catch{return e(new Error("Error while trying to fetch the emote list; is the emote server URL and/or access key set correctly?"))}u()})}),get:u=>{if(!Au)throw new Error("Store has not been initialized; call `store.initialize()` first.");return G[u]}};function du(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var nu,Bu;function de(){return Bu||(Bu=1,nu=/\uD83E\uDDD1(?:\uD83C\uDFFF\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83E\uDDD1(?:\uD83C[\uDFFC-\uDFFF]))|\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFF])|\uD83E\uDDD1(?:\uD83C\uDFFF\u200D\u2764\u200D\uD83D\uDC8B\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\u2764\u200D\uD83D\uDC8B\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\u2764\u200D\uD83D\uDC8B\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\u2764\u200D\uD83D\uDC8B\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D\u2764\u200D\uD83D\uDC8B\u200D\uD83E\uDDD1(?:\uD83C[\uDFFC-\uDFFF]))|\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])\u200D\u2764\u200D\uD83D\uDC8B\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D\u2764\u200D\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83D\uDC68|(?:\uD83C[\uDFFB-\uDFFF])\u200D\u2764\uFE0F\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF]))|\uD83E\uDDD1(?:\uD83C\uDFFF\u200D\u2764\uFE0F\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\u2764\uFE0F\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\u2764\uFE0F\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\u2764\uFE0F\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D\u2764\uFE0F\u200D\uD83E\uDDD1(?:\uD83C[\uDFFC-\uDFFF]))|\uD83D\uDC69\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D\u2764\uFE0F\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C\uDFC3|\uD83D\uDEB6|\uD83E\uDDCE)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]\uFE0F\u200D\u27A1\uFE0F|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83E\uDDD1\u200D\uD83E\uDDD1\u200D\uD83E\uDDD2\u200D\uD83E\uDDD2|(?:\uD83D\uDC68\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83D\uDC68|\uD83E\uDDD1\uD83C\uDFFF\u200D\u2764\u200D\uD83E\uDDD1)(?:\uD83C[\uDFFB-\uDFFE])|(?:\uD83D\uDC68\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC68|\uD83E\uDDD1\uD83C\uDFFE\u200D\u2764\u200D\uD83E\uDDD1)(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|(?:\uD83D\uDC68\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC68|\uD83E\uDDD1\uD83C\uDFFD\u200D\u2764\u200D\uD83E\uDDD1)(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|(?:\uD83D\uDC68\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC68|\uD83E\uDDD1\uD83C\uDFFC\u200D\u2764\u200D\uD83E\uDDD1)(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|(?:\uD83D\uDC68\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83D\uDC68|\uD83E\uDDD1\uD83C\uDFFB\u200D\u2764\u200D\uD83E\uDDD1)(?:\uD83C[\uDFFC-\uDFFF])|\uD83D\uDC69(?:\u200D(?:\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\u2764\u200D\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69]))|\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D(?:\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFC-\uDFFF])|(?:\uD83E[\uDDAF\uDDBC\uDDBD])\u200D\u27A1\uFE0F|\u2764\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFF]))|(?:\uD83C\uDFFF\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD]))\u200D\u27A1\uFE0F|(?:\uD83C[\uDFFC-\uDFFF])\u200D\u2764\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFF]))|\uD83D\uDC68\u200D\u2764\u200D\uD83D\uDC8B\u200D\uD83D\uDC68|\uD83D\uDC68\u200D(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])\u200D\u2764\u200D\uD83D\uDC68)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83E\uDDD1(?:\uD83C\uDFFF\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD]))|\uD83D\uDC68(?:\uD83C\uDFFF\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD]))|(?:\uD83C\uDFC3|\uD83D\uDEB6|\uD83E\uDDCE)\u200D[\u2640\u2642]\uFE0F)\u200D\u27A1\uFE0F|(?:\uD83C\uDFC3|\uD83D\uDEB6|\uD83E\uDDCE)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]\uFE0F\u200D\u27A1|(?:\uD83C\uDFC3|\uD83D\uDEB6|\uD83E\uDDCE)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]\u200D\u27A1\uFE0F|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D\uD83D\uDC68|(?:\uD83E[\uDDAF\uDDBC\uDDBD])\u200D\u27A1\uFE0F)|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])\u200D\u27A1)|\uD83D\uDC69\u200D\u2764\uFE0F\u200D(?:\uD83D[\uDC68\uDC69])|(?:\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF]))\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])\u200D\u27A1|(?:\uD83E\uDDD1\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83D\uDC69\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD]))\u200D\u27A1\uFE0F|(?:\uD83C\uDFC3|\uD83D\uDEB6|\uD83E\uDDCE)(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642]\uFE0F)\u200D\u27A1|(?:\uD83C\uDFC3|\uD83D\uDEB6|\uD83E\uDDCE)\u200D[\u2640\u2642]\u200D\u27A1\uFE0F|\uD83E\uDDD1\u200D(?:\uD83E\uDD1D\u200D\uD83E\uDDD1|(?:\uD83E[\uDDD1\uDDD2])\u200D\uD83E\uDDD2)|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC68(?:\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\u2764\u200D\uD83D\uDC68|(?:\uD83E[\uDDAF\uDDBC\uDDBD])\u200D\u27A1|(?:\uD83D[\uDC67-\uDC69])\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]\uFE0F)|\uD83E\uDEF1(?:\uD83C\uDFFF\u200D\uD83E\uDEF2(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\uD83E\uDEF2(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\uD83E\uDEF2(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\uD83E\uDEF2(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D\uD83E\uDEF2(?:\uD83C[\uDFFC-\uDFFF]))|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83C\uDFF3\uFE0F\u200D\u26A7|(?:\uD83C[\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C\uDFC3|\uD83D\uDEB6|\uD83E\uDDCE)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642\u27A1])\uFE0F|\uD83D\uDC69\u200D\u2764\u200D(?:\uD83D[\uDC68\uDC69])|(?:\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF]))\u200D[\u2695\u2696\u2708]\uFE0F|(?:\uD83E\uDDD1\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|\uD83D\uDC69\u200D(?:\uD83E[\uDDAF\uDDBC\uDDBD])|(?:\uD83C\uDFC3|\uD83D\uDEB6|\uD83E\uDDCE)\u200D[\u2640\u2642])\u200D\u27A1|\uD83D\uDC69\u200D(?:\uD83D[\uDC67\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|(?:\uD83D\uDE36\u200D\uD83C\uDF2B|\uD83D\uDC41\u200D\uD83D\uDDE8|\uD83D\uDE42\u200D[\u2194\u2195]|\uD83D\uDC3B\u200D\u2744|\uD83C\uDFF4\u200D\u2620|\uD83C\uDFF3\u200D\u26A7|\uD83E\uDDD1\u200D[\u2695\u2696\u2708]|(?:\uD83C[\uDFC4\uDFCA]|\uD83D[\uDC6E-\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3C-\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\u200D[\u2640\u2642]|(?:\uD83D[\uDC68\uDC69])\u200D[\u2695\u2696\u2708])\uFE0F|\uD83C\uDFF3\uFE0F\u200D(?:\u26A7|\uD83C\uDF08)|\u26D3\uFE0F\u200D\uD83D\uDCA5|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:[\u2695\u2696\u2708]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u2764\uFE0F\u200D(?:\uD83D\uDD25|\uD83E\uDE79)|(?:\uD83C[\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:[\u2695\u2696\u2708]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C\uDFC3|\uD83D\uDEB6|\uD83E\uDDCE)(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642\u27A1]|\u200D[\u2640\u2642\u27A1]\uFE0F)|\uD83D\uDE36\u200D\uD83C\uDF2B|\uD83D\uDE35\u200D\uD83D\uDCAB|\uD83D\uDE2E\u200D\uD83D\uDCA8|\uD83D\uDC41\u200D\uD83D\uDDE8|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83C\uDF4B\u200D\uD83D\uDFE9|\uD83C\uDF44\u200D\uD83D\uDFEB|\uD83D\uDE42\u200D[\u2194\u2195]|\uD83D\uDC3B\u200D\u2744|\uD83D\uDC26\u200D(?:\u2B1B|\uD83D\uDD25)|\uD83D\uDC08\u200D\u2B1B|\uD83C\uDFF4\u200D\u2620|\uD83C\uDFF3\u200D(?:\u26A7|\uD83C\uDF08)|\u26D3\u200D\uD83D\uDCA5|\uD83E\uDDD1\u200D(?:[\u2695\u2696\u2708]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD\uDDD2])|\u2764\u200D(?:\uD83D\uDD25|\uD83E\uDE79)|(?:\u26F9|\uD83C[\uDFC4\uDFCA-\uDFCC]|\uD83D[\uDC6E-\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDD75\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3C-\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDF])\u200D[\u2640\u2642]|(?:\uD83C\uDFC3|\uD83D\uDEB6|\uD83E\uDDCE)\u200D[\u2640\u2642\u27A1]|(?:\uD83D[\uDC68\uDC69])\u200D(?:[\u2695\u2696\u2708]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDC66\uDC67\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|[#\*0-9]\u20E3|(?:\uD83C[\uDF85\uDFC3\uDFC7]|\uD83D[\uDC43\uDC4A-\uDC4C\uDC4F\uDC50\uDC66-\uDC69\uDC6B-\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD\uDEC3-\uDEC5\uDEF0-\uDEF8])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDFC2\uDFC4\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC46-\uDC49\uDC4D\uDC4E\uDD74\uDD75\uDD90])(?:[\uFE0E\uFE0F]|\uD83C[\uDFFB-\uDFFF])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7\u26F8\u26FA\u26FD\u2702\u2705\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE1A\uDE2F\uDE37\uDF0D-\uDF0F\uDF15\uDF1C\uDF21\uDF24-\uDF2C\uDF36\uDF78\uDF7D\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFA7\uDFAC-\uDFAE\uDFC6\uDFCD\uDFCE\uDFD4-\uDFE0\uDFED\uDFF3\uDFF5\uDFF7]|\uD83D[\uDC08\uDC15\uDC1F\uDC26\uDC3F\uDC41\uDC53\uDC6A\uDC7D\uDCA3\uDCB0\uDCB3\uDCBB\uDCBF\uDCCB\uDCDA\uDCDF\uDCE4-\uDCE6\uDCEA-\uDCED\uDCF7\uDCF9-\uDCFB\uDCFD\uDD08\uDD0D\uDD12\uDD13\uDD49\uDD4A\uDD50-\uDD67\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDE10\uDE87\uDE8D\uDE91\uDE94\uDE98\uDEAD\uDEB2\uDEB9\uDEBA\uDEBC\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3])[\uFE0E\uFE0F]|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8]/),nu}var fe=de();const me=du(fe);/*!
 * element-emotes
 * Copyright (C) 2022-present  Michael Serajnik  https://github.com/mserajnik
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */let P,J;const ge=u=>{for(const e of g.get("emotes"))u=u.split(`:${e.name}:`).join("");return u},pe=u=>(u=ge(u.replace(/\s/g,"").replace(/[\u200D\u2003]/g,"").replace(new RegExp(me.source,"gi"),"")),u.trim()===""),Ae=u=>u.match(/^.+\/emotes\/.+\.(gif|apng)(\?.+)?$/)?u.split("/emotes/").join("/frozen-emotes/"):null,vu=(u=!1)=>{const e=document.querySelectorAll("[data-frozen-emote-url]");if(e.length)for(const n of e){if(u){n.src=n.dataset.frozenEmoteUrl;continue}n.src=n.dataset.emoteUrl}},_u=(u,e=!1)=>{if(u.dataset.emotesReplaced&&!e)return;const n=u.querySelector(".mx_EventTile_body");if(!n)return;let s=n.innerHTML;const D=pe(n.textContent)?`max-height:${g.get("largeEmoteSize")};vertical-align:bottom`:`max-height:${g.get("defaultEmoteSize")}`;for(const r of g.get("emotes")){const t=Ae(r.url);s=s.split(`:${r.name}:`).join(`<img
          style="${D}"`+(J&&t?document.hasFocus()?`src="${r.url}?accessKey=${P}"`:`src="${t}?accessKey=${P}"`:`src="${r.url}?accessKey=${P}"`)+`data-emote-url="${r.url}?accessKey=${P}"`+(J&&t?`data-frozen-emote-url="${t}?accessKey=${P}"`:"")+`alt="${r.name}"
          title="${r.name}">`)}n.innerHTML=s,u.dataset.emotesReplaced=!0},qu=u=>{if(u.classList&&u.classList.contains("mx_EventTile_content")){_u(u);return}if(u.classList&&u.classList.contains("mx_EventTile_edited")){_u(u.parentNode,!0);return}u.childNodes&&[...u.childNodes].forEach(qu)},Be={initialize:()=>{P=g.get("accessKey"),J=g.get("useFrozenEmotes"),new window.MutationObserver(u=>{for(const e of u)for(const n of e.addedNodes)qu(n)}).observe(document.body,{childList:!0,subtree:!0}),J&&(window.focus(),window.addEventListener("focus",()=>{vu(!1)}),window.addEventListener("blur",()=>{vu(!0)}))}};var O={},z={},ru={exports:{}},yu;function eu(){return yu||(yu=1,function(u){var e=Object.prototype.hasOwnProperty,n="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1));function D(o,c,a){this.fn=o,this.context=c,this.once=a||!1}function r(o,c,a,l,F){if(typeof a!="function")throw new TypeError("The listener must be a function");var E=new D(a,l||o,F),d=n?n+c:c;return o._events[d]?o._events[d].fn?o._events[d]=[o._events[d],E]:o._events[d].push(E):(o._events[d]=E,o._eventsCount++),o}function t(o,c){--o._eventsCount===0?o._events=new s:delete o._events[c]}function i(){this._events=new s,this._eventsCount=0}i.prototype.eventNames=function(){var c=[],a,l;if(this._eventsCount===0)return c;for(l in a=this._events)e.call(a,l)&&c.push(n?l.slice(1):l);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(a)):c},i.prototype.listeners=function(c){var a=n?n+c:c,l=this._events[a];if(!l)return[];if(l.fn)return[l.fn];for(var F=0,E=l.length,d=new Array(E);F<E;F++)d[F]=l[F].fn;return d},i.prototype.listenerCount=function(c){var a=n?n+c:c,l=this._events[a];return l?l.fn?1:l.length:0},i.prototype.emit=function(c,a,l,F,E,d){var m=n?n+c:c;if(!this._events[m])return!1;var h=this._events[m],p=arguments.length,A,f;if(h.fn){switch(h.once&&this.removeListener(c,h.fn,void 0,!0),p){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,a),!0;case 3:return h.fn.call(h.context,a,l),!0;case 4:return h.fn.call(h.context,a,l,F),!0;case 5:return h.fn.call(h.context,a,l,F,E),!0;case 6:return h.fn.call(h.context,a,l,F,E,d),!0}for(f=1,A=new Array(p-1);f<p;f++)A[f-1]=arguments[f];h.fn.apply(h.context,A)}else{var w=h.length,L;for(f=0;f<w;f++)switch(h[f].once&&this.removeListener(c,h[f].fn,void 0,!0),p){case 1:h[f].fn.call(h[f].context);break;case 2:h[f].fn.call(h[f].context,a);break;case 3:h[f].fn.call(h[f].context,a,l);break;case 4:h[f].fn.call(h[f].context,a,l,F);break;default:if(!A)for(L=1,A=new Array(p-1);L<p;L++)A[L-1]=arguments[L];h[f].fn.apply(h[f].context,A)}}return!0},i.prototype.on=function(c,a,l){return r(this,c,a,l,!1)},i.prototype.once=function(c,a,l){return r(this,c,a,l,!0)},i.prototype.removeListener=function(c,a,l,F){var E=n?n+c:c;if(!this._events[E])return this;if(!a)return t(this,E),this;var d=this._events[E];if(d.fn)d.fn===a&&(!F||d.once)&&(!l||d.context===l)&&t(this,E);else{for(var m=0,h=[],p=d.length;m<p;m++)(d[m].fn!==a||F&&!d[m].once||l&&d[m].context!==l)&&h.push(d[m]);h.length?this._events[E]=h.length===1?h[0]:h:t(this,E)}return this},i.prototype.removeAllListeners=function(c){var a;return c?(a=n?n+c:c,this._events[a]&&t(this,a)):(this._events=new s,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=n,i.EventEmitter=i,u.exports=i}(ru)),ru.exports}var su={},j={},wu;function Qu(){if(wu)return j;wu=1,Object.defineProperty(j,"__esModule",{value:!0}),j.SearchResult=void 0;const u=/\$&/g,e=/\$(\d)/g;let n=class{constructor(D,r,t){this.data=D,this.term=r,this.strategy=t}getReplacementData(D){let r=this.strategy.replace(this.data);if(r==null)return null;let t="";Array.isArray(r)&&(t=r[1],r=r[0]);const i=this.strategy.match(D);if(i==null||i.index==null)return null;const o=r.replace(u,i[0]).replace(e,(c,a)=>i[parseInt(a)]);return{start:i.index,end:i.index+i[0].length,beforeCursor:o,afterCursor:t}}replace(D,r){const t=this.getReplacementData(D);if(t!==null)return r=t.afterCursor+r,[[D.slice(0,t.start),t.beforeCursor,D.slice(t.end)].join(""),r]}render(){return this.strategy.renderTemplate(this.data,this.term)}getStrategyId(){return this.strategy.getId()}};return j.SearchResult=n,j}var Mu;function Vu(){return Mu||(Mu=1,function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.Strategy=u.DEFAULT_INDEX=void 0;const e=Qu();u.DEFAULT_INDEX=1;class n{constructor(D){this.props=D,this.cache={}}destroy(){return this.cache={},this}replace(D){return this.props.replace(D)}execute(D,r){var t;const i=this.matchWithContext(D);if(!i)return!1;const o=i[(t=this.props.index)!==null&&t!==void 0?t:u.DEFAULT_INDEX];return this.search(o,c=>{r(c.map(a=>new e.SearchResult(a,o,this)))},i),!0}renderTemplate(D,r){if(this.props.template)return this.props.template(D,r);if(typeof D=="string")return D;throw new Error(`Unexpected render data type: ${typeof D}. Please implement template parameter by yourself`)}getId(){return this.props.id||null}match(D){return typeof this.props.match=="function"?this.props.match(D):D.match(this.props.match)}search(D,r,t){this.props.cache?this.searchWithCach(D,r,t):this.props.search(D,r,t)}matchWithContext(D){const r=this.context(D);return r===!1?null:this.match(r===!0?D:r)}context(D){return this.props.context?this.props.context(D):!0}searchWithCach(D,r,t){this.cache[D]!=null?r(this.cache[D]):this.props.search(D,i=>{this.cache[D]=i,r(i)},t)}}u.Strategy=n}(su)),su}var xu;function Gu(){if(xu)return z;xu=1,Object.defineProperty(z,"__esModule",{value:!0}),z.Completer=void 0;const u=eu(),e=Vu();let n=class extends u.EventEmitter{constructor(D){super(),this.handleQueryResult=r=>{this.emit("hit",{searchResults:r})},this.strategies=D.map(r=>new e.Strategy(r))}destroy(){return this.strategies.forEach(D=>D.destroy()),this}run(D){for(const r of this.strategies)if(r.execute(D,this.handleQueryResult))return;this.handleQueryResult([])}};return z.Completer=n,z}var iu={},U={},bu;function fu(){if(bu)return U;bu=1,Object.defineProperty(U,"__esModule",{value:!0}),U.createCustomEvent=void 0;const u=typeof window<"u"&&!!window.CustomEvent,e=(n,s)=>{if(u)return new CustomEvent(n,s);const D=document.createEvent("CustomEvent");return D.initCustomEvent(n,!1,(s==null?void 0:s.cancelable)||!1,(s==null?void 0:s.detail)||void 0),D};return U.createCustomEvent=e,U}var Su;function Xu(){return Su||(Su=1,function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.Dropdown=u.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME=u.DEFAULT_DROPDOWN_ITEM_CLASS_NAME=u.DEFAULT_DROPDOWN_CLASS_NAME=u.DEFAULT_DROPDOWN_PLACEMENT=u.DEFAULT_DROPDOWN_MAX_COUNT=void 0;const e=eu(),n=fu();u.DEFAULT_DROPDOWN_MAX_COUNT=10,u.DEFAULT_DROPDOWN_PLACEMENT="auto",u.DEFAULT_DROPDOWN_CLASS_NAME="dropdown-menu textcomplete-dropdown",u.DEFAULT_DROPDOWN_ITEM_CLASS_NAME="textcomplete-item",u.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME=`${u.DEFAULT_DROPDOWN_ITEM_CLASS_NAME} active`;class s extends e.EventEmitter{static create(t){const i=document.createElement("ul");i.className=t.className||u.DEFAULT_DROPDOWN_CLASS_NAME,Object.assign(i.style,{display:"none",position:"absolute",zIndex:"1000"},t.style);const o=t.parent||document.body;return o==null||o.appendChild(i),new s(i,t)}constructor(t,i){super(),this.el=t,this.option=i,this.shown=!1,this.items=[],this.activeIndex=null}render(t,i){const o=(0,n.createCustomEvent)("render",{cancelable:!0});return this.emit("render",o),o.defaultPrevented?this:(this.clear(),t.length===0?this.hide():(this.items=t.slice(0,this.option.maxCount||u.DEFAULT_DROPDOWN_MAX_COUNT).map((c,a)=>{var l;return new D(this,a,c,((l=this.option)===null||l===void 0?void 0:l.item)||{})}),this.setStrategyId(t[0]).renderEdge(t,"header").renderItems().renderEdge(t,"footer").show().setOffset(i).activate(0),this.emit("rendered",(0,n.createCustomEvent)("rendered")),this))}destroy(){var t;return this.clear(),(t=this.el.parentNode)===null||t===void 0||t.removeChild(this.el),this}select(t){const i={searchResult:t.searchResult},o=(0,n.createCustomEvent)("select",{cancelable:!0,detail:i});return this.emit("select",o),o.defaultPrevented?this:(this.hide(),this.emit("selected",(0,n.createCustomEvent)("selected",{detail:i})),this)}show(){if(!this.shown){const t=(0,n.createCustomEvent)("show",{cancelable:!0});if(this.emit("show",t),t.defaultPrevented)return this;this.el.style.display="block",this.shown=!0,this.emit("shown",(0,n.createCustomEvent)("shown"))}return this}hide(){if(this.shown){const t=(0,n.createCustomEvent)("hide",{cancelable:!0});if(this.emit("hide",t),t.defaultPrevented)return this;this.el.style.display="none",this.shown=!1,this.clear(),this.emit("hidden",(0,n.createCustomEvent)("hidden"))}return this}clear(){return this.items.forEach(t=>t.destroy()),this.items=[],this.el.innerHTML="",this.activeIndex=null,this}up(t){return this.shown?this.moveActiveItem("prev",t):this}down(t){return this.shown?this.moveActiveItem("next",t):this}moveActiveItem(t,i){if(this.activeIndex!=null){const o=t==="next"?this.getNextActiveIndex():this.getPrevActiveIndex();o!=null&&(this.activate(o),i.preventDefault())}return this}activate(t){return this.activeIndex!==t&&(this.activeIndex!=null&&this.items[this.activeIndex].deactivate(),this.activeIndex=t,this.items[t].activate()),this}isShown(){return this.shown}getActiveItem(){return this.activeIndex!=null?this.items[this.activeIndex]:null}setOffset(t){const i=document.documentElement;if(i){const o=this.el.offsetWidth;if(t.left){const l=this.option.dynamicWidth?i.scrollWidth:i.clientWidth;t.left+o>l&&(t.left=l-o),this.el.style.left=`${t.left}px`}else t.right&&(t.right-o<0&&(t.right=0),this.el.style.right=`${t.right}px`);let c=!1;const a=this.option.placement||u.DEFAULT_DROPDOWN_PLACEMENT;if(a==="auto"){const l=this.items.length*t.lineHeight;c=t.clientTop!=null&&t.clientTop+l>i.clientHeight}a==="top"||c?(this.el.style.bottom=`${i.clientHeight-t.top+t.lineHeight}px`,this.el.style.top="auto"):(this.el.style.top=`${t.top}px`,this.el.style.bottom="auto")}return this}getNextActiveIndex(){if(this.activeIndex==null)throw new Error;return this.activeIndex<this.items.length-1?this.activeIndex+1:this.option.rotate?0:null}getPrevActiveIndex(){if(this.activeIndex==null)throw new Error;return this.activeIndex!==0?this.activeIndex-1:this.option.rotate?this.items.length-1:null}renderItems(){const t=document.createDocumentFragment();for(const i of this.items)t.appendChild(i.el);return this.el.appendChild(t),this}setStrategyId(t){const i=t.getStrategyId();return i&&(this.el.dataset.strategy=i),this}renderEdge(t,i){const o=this.option[i],c=document.createElement("li");return c.className=`textcomplete-${i}`,c.innerHTML=typeof o=="function"?o(t.map(a=>a.data)):o||"",this.el.appendChild(c),this}}u.Dropdown=s;class D{constructor(t,i,o,c){this.dropdown=t,this.index=i,this.searchResult=o,this.props=c,this.active=!1,this.onClick=F=>{F.preventDefault(),this.dropdown.select(this)},this.className=this.props.className||u.DEFAULT_DROPDOWN_ITEM_CLASS_NAME,this.activeClassName=this.props.activeClassName||u.DEFAULT_DROPDOWN_ITEM_ACTIVE_CLASS_NAME;const a=document.createElement("li");a.className=this.active?this.activeClassName:this.className;const l=document.createElement("span");l.tabIndex=-1,l.innerHTML=this.searchResult.render(),a.appendChild(l),a.addEventListener("click",this.onClick),this.el=a}destroy(){var t;const i=this.el;return(t=i.parentNode)===null||t===void 0||t.removeChild(i),i.removeEventListener("click",this.onClick,!1),this}activate(){return this.active||(this.active=!0,this.el.className=this.activeClassName,this.dropdown.el.scrollTop=this.el.offsetTop),this}deactivate(){return this.active&&(this.active=!1,this.el.className=this.className),this}}}(iu)),iu}var W={},Lu;function ve(){if(Lu)return W;Lu=1,Object.defineProperty(W,"__esModule",{value:!0}),W.Editor=void 0;const u=eu(),e=fu();let n=class extends u.EventEmitter{destroy(){return this}applySearchResult(D){throw new Error("Not implemented.")}getCursorOffset(){throw new Error("Not implemented.")}getBeforeCursor(){throw new Error("Not implemented.")}emitMoveEvent(D){const r=(0,e.createCustomEvent)("move",{cancelable:!0,detail:{code:D}});return this.emit("move",r),r}emitEnterEvent(){const D=(0,e.createCustomEvent)("enter",{cancelable:!0});return this.emit("enter",D),D}emitChangeEvent(){const D=(0,e.createCustomEvent)("change",{detail:{beforeCursor:this.getBeforeCursor()}});return this.emit("change",D),D}emitEscEvent(){const D=(0,e.createCustomEvent)("esc",{cancelable:!0});return this.emit("esc",D),D}getCode(D){switch(D.keyCode){case 9:case 13:return"ENTER";case 27:return"ESC";case 38:return"UP";case 40:return"DOWN";case 78:if(D.ctrlKey)return"DOWN";break;case 80:if(D.ctrlKey)return"UP";break}return"OTHER"}};return W.Editor=n,W}var H={},Ou;function _e(){if(Ou)return H;Ou=1,Object.defineProperty(H,"__esModule",{value:!0}),H.Textcomplete=void 0;const u=eu(),e=Xu(),n=Gu(),s=["show","shown","render","rendered","selected","hidden","hide"];class D extends u.EventEmitter{constructor(t,i,o){super(),this.editor=t,this.isQueryInFlight=!1,this.nextPendingQuery=null,this.handleHit=({searchResults:c})=>{c.length?this.dropdown.render(c,this.editor.getCursorOffset()):this.dropdown.hide(),this.isQueryInFlight=!1,this.nextPendingQuery!==null&&this.trigger(this.nextPendingQuery)},this.handleMove=c=>{c.detail.code==="UP"?this.dropdown.up(c):this.dropdown.down(c)},this.handleEnter=c=>{const a=this.dropdown.getActiveItem();a?(this.dropdown.select(a),c.preventDefault()):this.dropdown.hide()},this.handleEsc=c=>{this.dropdown.isShown()&&(this.dropdown.hide(),c.preventDefault())},this.handleChange=c=>{c.detail.beforeCursor!=null?this.trigger(c.detail.beforeCursor):this.dropdown.hide()},this.handleSelect=c=>{this.emit("select",c),c.defaultPrevented||this.editor.applySearchResult(c.detail.searchResult)},this.handleResize=()=>{this.dropdown.isShown()&&this.dropdown.setOffset(this.editor.getCursorOffset())},this.completer=new n.Completer(i),this.dropdown=e.Dropdown.create((o==null?void 0:o.dropdown)||{}),this.startListening()}destroy(t=!0){return this.completer.destroy(),this.dropdown.destroy(),t&&this.editor.destroy(),this.stopListening(),this}isShown(){return this.dropdown.isShown()}hide(){return this.dropdown.hide(),this}trigger(t){return this.isQueryInFlight?this.nextPendingQuery=t:(this.isQueryInFlight=!0,this.nextPendingQuery=null,this.completer.run(t)),this}startListening(){var t;this.editor.on("move",this.handleMove).on("enter",this.handleEnter).on("esc",this.handleEsc).on("change",this.handleChange),this.dropdown.on("select",this.handleSelect);for(const i of s)this.dropdown.on(i,o=>this.emit(i,o));this.completer.on("hit",this.handleHit),(t=this.dropdown.el.ownerDocument.defaultView)===null||t===void 0||t.addEventListener("resize",this.handleResize)}stopListening(){var t;(t=this.dropdown.el.ownerDocument.defaultView)===null||t===void 0||t.removeEventListener("resize",this.handleResize),this.completer.removeAllListeners(),this.dropdown.removeAllListeners(),this.editor.removeListener("move",this.handleMove).removeListener("enter",this.handleEnter).removeListener("esc",this.handleEsc).removeListener("change",this.handleChange)}}return H.Textcomplete=D,H}var Iu;function Yu(){return Iu||(Iu=1,function(u){var e=O&&O.__createBinding||(Object.create?function(s,D,r,t){t===void 0&&(t=r);var i=Object.getOwnPropertyDescriptor(D,r);(!i||("get"in i?!D.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return D[r]}}),Object.defineProperty(s,t,i)}:function(s,D,r,t){t===void 0&&(t=r),s[t]=D[r]}),n=O&&O.__exportStar||function(s,D){for(var r in s)r!=="default"&&!Object.prototype.hasOwnProperty.call(D,r)&&e(D,s,r)};Object.defineProperty(u,"__esModule",{value:!0}),n(Gu(),u),n(Xu(),u),n(ve(),u),n(Qu(),u),n(Vu(),u),n(_e(),u),n(fu(),u)}(O)),O}var Ju=Yu();const Zu=du(Ju),ye=Ku({__proto__:null,default:Zu},[Ju]);var I={},k={},R={},K={},Ru;function we(){if(Ru)return K;Ru=1,Object.defineProperty(K,"__esModule",{value:!0}),K.calculateElementOffset=void 0;const u=e=>{const n=e.getBoundingClientRect(),s=e.ownerDocument;if(s==null)throw new Error("Given element does not belong to document");const{defaultView:D,documentElement:r}=s;if(D==null)throw new Error("Given element does not belong to window");const t={top:n.top+D.pageYOffset,left:n.left+D.pageXOffset};return r&&(t.top-=r.clientTop,t.left-=r.clientLeft),t};return K.calculateElementOffset=u,K}var q={},Nu;function Me(){if(Nu)return q;Nu=1,Object.defineProperty(q,"__esModule",{value:!0}),q.getLineHeightPx=void 0;const u=48,e=57,n=r=>u<=r&&r<=e,s=r=>{const t=getComputedStyle(r),i=t.lineHeight;if(n(i.charCodeAt(0))){const o=parseFloat(i);return n(i.charCodeAt(i.length-1))?o*parseFloat(t.fontSize):o}return D(r.nodeName,t)};q.getLineHeightPx=s;const D=(r,t)=>{const i=document.body;if(!i)return 0;const o=document.createElement(r);o.innerHTML="&nbsp;",Object.assign(o.style,{fontSize:t.fontSize,fontFamily:t.fontFamily,padding:"0"}),i.appendChild(o),o instanceof HTMLTextAreaElement&&(o.rows=1);const c=o.offsetHeight;return i.removeChild(o),c};return q}var Q={},Tu;function xe(){if(Tu)return Q;Tu=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.isSafari=void 0;const u=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return Q.isSafari=u,Q}var Pu;function be(){return Pu||(Pu=1,function(u){var e=R&&R.__createBinding||(Object.create?function(s,D,r,t){t===void 0&&(t=r);var i=Object.getOwnPropertyDescriptor(D,r);(!i||("get"in i?!D.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return D[r]}}),Object.defineProperty(s,t,i)}:function(s,D,r,t){t===void 0&&(t=r),s[t]=D[r]}),n=R&&R.__exportStar||function(s,D){for(var r in s)r!=="default"&&!Object.prototype.hasOwnProperty.call(D,r)&&e(D,s,r)};Object.defineProperty(u,"__esModule",{value:!0}),n(we(),u),n(Me(),u),n(xe(),u)}(R)),R}var $u;function Se(){if($u)return k;$u=1,Object.defineProperty(k,"__esModule",{value:!0}),k.ContenteditableEditor=void 0;const u=Yu(),e=be();class n extends u.Editor{constructor(D){super(),this.el=D,this.onInput=()=>{this.el.normalize(),this.emitChangeEvent()},this.onKeydown=r=>{const t=this.getCode(r);let i;t==="UP"||t==="DOWN"?i=this.emitMoveEvent(t):t==="ENTER"?i=this.emitEnterEvent():t==="ESC"&&(i=this.emitEscEvent()),i&&i.defaultPrevented&&r.preventDefault()},this.startListening=()=>{this.el.addEventListener("input",this.onInput),this.el.addEventListener("keydown",this.onKeydown)},this.stopListening=()=>{this.el.removeEventListener("input",this.onInput),this.el.removeEventListener("keydown",this.onKeydown)},this.startListening()}destroy(){return super.destroy(),this.stopListening(),this}applySearchResult(D){const r=this.getBeforeCursor(),t=this.getAfterCursor();if(r!=null&&t!=null){const i=D.replace(r,t);if(Array.isArray(i)){let o=i[0];(0,e.isSafari)()&&(o=o.replace(r,""));const c=this.getRange();if(c.selectNode(c.startContainer),this.el.dataset.requiresManualDeletions){for(let l=0;l<r.length;l++)this.el.ownerDocument.execCommand("delete",!1,null);for(let l=0;l<t.length;l++)this.el.ownerDocument.execCommand("forwardDelete",!1,null)}this.el.ownerDocument.execCommand("insertText",!1,o+i[1]),c.detach();const a=this.getRange();a.setStart(a.startContainer,o.length),a.collapse(!0)}}}getCursorOffset(){const D=this.getRange(),r=D.getBoundingClientRect(),t=this.el.ownerDocument.body.getBoundingClientRect(),i=D.startContainer,o=i instanceof Text?i.parentElement:i,c=r.left,a=(0,e.getLineHeightPx)(o),l=r.top-t.top+a;return this.el.dir!=="rtl"?{left:c,lineHeight:a,top:l}:{right:document.documentElement.clientWidth-c,lineHeight:a,top:l}}getBeforeCursor(){const D=this.getRange();return D.collapsed&&D.startContainer instanceof Text?D.startContainer.wholeText.substring(0,D.startOffset):null}getAfterCursor(){const D=this.getRange();return D.collapsed&&D.startContainer instanceof Text?D.startContainer.wholeText.substring(D.startOffset):null}getRange(D){var r;const t=(r=this.el.ownerDocument.defaultView)===null||r===void 0?void 0:r.getSelection();if(t==null)throw new Error("The element does not belong to view");for(let c=0,a=t.rangeCount;c<a;c++){const l=t.getRangeAt(c);if(this.el.contains(l.startContainer))return l}if(D)throw new Error("Unexpected");const i=this.el.ownerDocument.activeElement;this.el.focus();const o=this.getRange(!0);if(i){const c=i;c.focus&&c.focus()}return o}}return k.ContenteditableEditor=n,k}var zu;function Le(){return zu||(zu=1,function(u){var e=I&&I.__createBinding||(Object.create?function(s,D,r,t){t===void 0&&(t=r);var i=Object.getOwnPropertyDescriptor(D,r);(!i||("get"in i?!D.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return D[r]}}),Object.defineProperty(s,t,i)}:function(s,D,r,t){t===void 0&&(t=r),s[t]=D[r]}),n=I&&I.__exportStar||function(s,D){for(var r in s)r!=="default"&&!Object.prototype.hasOwnProperty.call(D,r)&&e(D,s,r)};Object.defineProperty(u,"__esModule",{value:!0}),n(Se(),u)}(I)),I}var ue=Le();const ee=du(ue),Oe=Ku({__proto__:null,default:ee},[ue]);function M(u){return Array.isArray?Array.isArray(u):ne(u)==="[object Array]"}function Ie(u){if(typeof u=="string")return u;let e=u+"";return e=="0"&&1/u==-1/0?"-0":e}function Re(u){return u==null?"":Ie(u)}function y(u){return typeof u=="string"}function te(u){return typeof u=="number"}function Ne(u){return u===!0||u===!1||Te(u)&&ne(u)=="[object Boolean]"}function De(u){return typeof u=="object"}function Te(u){return De(u)&&u!==null}function B(u){return u!=null}function ou(u){return!u.trim().length}function ne(u){return u==null?u===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(u)}const Pe="Incorrect 'index' type",$e=u=>`Invalid value for key ${u}`,ze=u=>`Pattern length exceeds max of ${u}.`,je=u=>`Missing ${u} property in key`,Ue=u=>`Property 'weight' in key '${u}' must be a positive integer`,ju=Object.prototype.hasOwnProperty;class We{constructor(e){this._keys=[],this._keyMap={};let n=0;e.forEach(s=>{let D=re(s);this._keys.push(D),this._keyMap[D.id]=D,n+=D.weight}),this._keys.forEach(s=>{s.weight/=n})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function re(u){let e=null,n=null,s=null,D=1,r=null;if(y(u)||M(u))s=u,e=Uu(u),n=cu(u);else{if(!ju.call(u,"name"))throw new Error(je("name"));const t=u.name;if(s=t,ju.call(u,"weight")&&(D=u.weight,D<=0))throw new Error(Ue(t));e=Uu(t),n=cu(t),r=u.getFn}return{path:e,id:n,weight:D,src:s,getFn:r}}function Uu(u){return M(u)?u:u.split(".")}function cu(u){return M(u)?u.join("."):u}function He(u,e){let n=[],s=!1;const D=(r,t,i)=>{if(B(r))if(!t[i])n.push(r);else{let o=t[i];const c=r[o];if(!B(c))return;if(i===t.length-1&&(y(c)||te(c)||Ne(c)))n.push(Re(c));else if(M(c)){s=!0;for(let a=0,l=c.length;a<l;a+=1)D(c[a],t,i+1)}else t.length&&D(c,t,i+1)}};return D(u,y(e)?e.split("."):e,0),s?n:n[0]}const ke={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Ke={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(u,e)=>u.score===e.score?u.idx<e.idx?-1:1:u.score<e.score?-1:1},qe={location:0,threshold:.6,distance:100},Qe={useExtendedSearch:!1,getFn:He,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var C={...Ke,...ke,...qe,...Qe};const Ve=/[^ ]+/g;function Ge(u=1,e=3){const n=new Map,s=Math.pow(10,e);return{get(D){const r=D.match(Ve).length;if(n.has(r))return n.get(r);const t=1/Math.pow(r,.5*u),i=parseFloat(Math.round(t*s)/s);return n.set(r,i),i},clear(){n.clear()}}}class mu{constructor({getFn:e=C.getFn,fieldNormWeight:n=C.fieldNormWeight}={}){this.norm=Ge(n,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((n,s)=>{this._keysMap[n.id]=s})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,y(this.docs[0])?this.docs.forEach((e,n)=>{this._addString(e,n)}):this.docs.forEach((e,n)=>{this._addObject(e,n)}),this.norm.clear())}add(e){const n=this.size();y(e)?this._addString(e,n):this._addObject(e,n)}removeAt(e){this.records.splice(e,1);for(let n=e,s=this.size();n<s;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(e,n){return e[this._keysMap[n]]}size(){return this.records.length}_addString(e,n){if(!B(e)||ou(e))return;let s={v:e,i:n,n:this.norm.get(e)};this.records.push(s)}_addObject(e,n){let s={i:n,$:{}};this.keys.forEach((D,r)=>{let t=D.getFn?D.getFn(e):this.getFn(e,D.path);if(B(t)){if(M(t)){let i=[];const o=[{nestedArrIndex:-1,value:t}];for(;o.length;){const{nestedArrIndex:c,value:a}=o.pop();if(B(a))if(y(a)&&!ou(a)){let l={v:a,i:c,n:this.norm.get(a)};i.push(l)}else M(a)&&a.forEach((l,F)=>{o.push({nestedArrIndex:F,value:l})})}s.$[r]=i}else if(y(t)&&!ou(t)){let i={v:t,n:this.norm.get(t)};s.$[r]=i}}}),this.records.push(s)}toJSON(){return{keys:this.keys,records:this.records}}}function se(u,e,{getFn:n=C.getFn,fieldNormWeight:s=C.fieldNormWeight}={}){const D=new mu({getFn:n,fieldNormWeight:s});return D.setKeys(u.map(re)),D.setSources(e),D.create(),D}function Xe(u,{getFn:e=C.getFn,fieldNormWeight:n=C.fieldNormWeight}={}){const{keys:s,records:D}=u,r=new mu({getFn:e,fieldNormWeight:n});return r.setKeys(s),r.setIndexRecords(D),r}function X(u,{errors:e=0,currentLocation:n=0,expectedLocation:s=0,distance:D=C.distance,ignoreLocation:r=C.ignoreLocation}={}){const t=e/u.length;if(r)return t;const i=Math.abs(s-n);return D?t+i/D:i?1:t}function Ye(u=[],e=C.minMatchCharLength){let n=[],s=-1,D=-1,r=0;for(let t=u.length;r<t;r+=1){let i=u[r];i&&s===-1?s=r:!i&&s!==-1&&(D=r-1,D-s+1>=e&&n.push([s,D]),s=-1)}return u[r-1]&&r-s>=e&&n.push([s,r-1]),n}const N=32;function Je(u,e,n,{location:s=C.location,distance:D=C.distance,threshold:r=C.threshold,findAllMatches:t=C.findAllMatches,minMatchCharLength:i=C.minMatchCharLength,includeMatches:o=C.includeMatches,ignoreLocation:c=C.ignoreLocation}={}){if(e.length>N)throw new Error(ze(N));const a=e.length,l=u.length,F=Math.max(0,Math.min(s,l));let E=r,d=F;const m=i>1||o,h=m?Array(l):[];let p;for(;(p=u.indexOf(e,d))>-1;){let v=X(e,{currentLocation:p,expectedLocation:F,distance:D,ignoreLocation:c});if(E=Math.min(v,E),d=p+a,m){let x=0;for(;x<a;)h[p+x]=1,x+=1}}d=-1;let A=[],f=1,w=a+l;const L=1<<a-1;for(let v=0;v<a;v+=1){let x=0,b=w;for(;x<b;)X(e,{errors:v,currentLocation:F+b,expectedLocation:F,distance:D,ignoreLocation:c})<=E?x=b:w=b,b=Math.floor((w-x)/2+x);w=b;let gu=Math.max(1,F-b+1),Du=t?l:Math.min(F+b,l)+a,T=Array(Du+2);T[Du+1]=(1<<v)-1;for(let _=Du;_>=gu;_-=1){let V=_-1,pu=n[u.charAt(V)];if(m&&(h[V]=+!!pu),T[_]=(T[_+1]<<1|1)&pu,v&&(T[_]|=(A[_+1]|A[_])<<1|1|A[_+1]),T[_]&L&&(f=X(e,{errors:v,currentLocation:V,expectedLocation:F,distance:D,ignoreLocation:c}),f<=E)){if(E=f,d=V,d<=F)break;gu=Math.max(1,2*F-d)}}if(X(e,{errors:v+1,currentLocation:F,expectedLocation:F,distance:D,ignoreLocation:c})>E)break;A=T}const tu={isMatch:d>=0,score:Math.max(.001,f)};if(m){const v=Ye(h,i);v.length?o&&(tu.indices=v):tu.isMatch=!1}return tu}function Ze(u){let e={};for(let n=0,s=u.length;n<s;n+=1){const D=u.charAt(n);e[D]=(e[D]||0)|1<<s-n-1}return e}const Z=String.prototype.normalize?u=>u.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):u=>u;class ie{constructor(e,{location:n=C.location,threshold:s=C.threshold,distance:D=C.distance,includeMatches:r=C.includeMatches,findAllMatches:t=C.findAllMatches,minMatchCharLength:i=C.minMatchCharLength,isCaseSensitive:o=C.isCaseSensitive,ignoreDiacritics:c=C.ignoreDiacritics,ignoreLocation:a=C.ignoreLocation}={}){if(this.options={location:n,threshold:s,distance:D,includeMatches:r,findAllMatches:t,minMatchCharLength:i,isCaseSensitive:o,ignoreDiacritics:c,ignoreLocation:a},e=o?e:e.toLowerCase(),e=c?Z(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const l=(E,d)=>{this.chunks.push({pattern:E,alphabet:Ze(E),startIndex:d})},F=this.pattern.length;if(F>N){let E=0;const d=F%N,m=F-d;for(;E<m;)l(this.pattern.substr(E,N),E),E+=N;if(d){const h=F-N;l(this.pattern.substr(h),h)}}else l(this.pattern,0)}searchIn(e){const{isCaseSensitive:n,ignoreDiacritics:s,includeMatches:D}=this.options;if(e=n?e:e.toLowerCase(),e=s?Z(e):e,this.pattern===e){let m={isMatch:!0,score:0};return D&&(m.indices=[[0,e.length-1]]),m}const{location:r,distance:t,threshold:i,findAllMatches:o,minMatchCharLength:c,ignoreLocation:a}=this.options;let l=[],F=0,E=!1;this.chunks.forEach(({pattern:m,alphabet:h,startIndex:p})=>{const{isMatch:A,score:f,indices:w}=Je(e,m,h,{location:r+p,distance:t,threshold:i,findAllMatches:o,minMatchCharLength:c,includeMatches:D,ignoreLocation:a});A&&(E=!0),F+=f,A&&w&&(l=[...l,...w])});let d={isMatch:E,score:E?F/this.chunks.length:1};return E&&D&&(d.indices=l),d}}class S{constructor(e){this.pattern=e}static isMultiMatch(e){return Wu(e,this.multiRegex)}static isSingleMatch(e){return Wu(e,this.singleRegex)}search(){}}function Wu(u,e){const n=u.match(e);return n?n[1]:null}class ut extends S{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const n=e===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class et extends S{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const s=e.indexOf(this.pattern)===-1;return{isMatch:s,score:s?0:1,indices:[0,e.length-1]}}}class tt extends S{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const n=e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class Dt extends S{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const n=!e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class nt extends S{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const n=e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class rt extends S{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const n=!e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class oe extends S{constructor(e,{location:n=C.location,threshold:s=C.threshold,distance:D=C.distance,includeMatches:r=C.includeMatches,findAllMatches:t=C.findAllMatches,minMatchCharLength:i=C.minMatchCharLength,isCaseSensitive:o=C.isCaseSensitive,ignoreDiacritics:c=C.ignoreDiacritics,ignoreLocation:a=C.ignoreLocation}={}){super(e),this._bitapSearch=new ie(e,{location:n,threshold:s,distance:D,includeMatches:r,findAllMatches:t,minMatchCharLength:i,isCaseSensitive:o,ignoreDiacritics:c,ignoreLocation:a})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class ce extends S{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let n=0,s;const D=[],r=this.pattern.length;for(;(s=e.indexOf(this.pattern,n))>-1;)n=s+r,D.push([s,n-1]);const t=!!D.length;return{isMatch:t,score:t?0:1,indices:D}}}const au=[ut,ce,tt,Dt,rt,nt,et,oe],Hu=au.length,st=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,it="|";function ot(u,e={}){return u.split(it).map(n=>{let s=n.trim().split(st).filter(r=>r&&!!r.trim()),D=[];for(let r=0,t=s.length;r<t;r+=1){const i=s[r];let o=!1,c=-1;for(;!o&&++c<Hu;){const a=au[c];let l=a.isMultiMatch(i);l&&(D.push(new a(l,e)),o=!0)}if(!o)for(c=-1;++c<Hu;){const a=au[c];let l=a.isSingleMatch(i);if(l){D.push(new a(l,e));break}}}return D})}const ct=new Set([oe.type,ce.type]);class at{constructor(e,{isCaseSensitive:n=C.isCaseSensitive,ignoreDiacritics:s=C.ignoreDiacritics,includeMatches:D=C.includeMatches,minMatchCharLength:r=C.minMatchCharLength,ignoreLocation:t=C.ignoreLocation,findAllMatches:i=C.findAllMatches,location:o=C.location,threshold:c=C.threshold,distance:a=C.distance}={}){this.query=null,this.options={isCaseSensitive:n,ignoreDiacritics:s,includeMatches:D,minMatchCharLength:r,findAllMatches:i,ignoreLocation:t,location:o,threshold:c,distance:a},e=n?e:e.toLowerCase(),e=s?Z(e):e,this.pattern=e,this.query=ot(this.pattern,this.options)}static condition(e,n){return n.useExtendedSearch}searchIn(e){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:s,isCaseSensitive:D,ignoreDiacritics:r}=this.options;e=D?e:e.toLowerCase(),e=r?Z(e):e;let t=0,i=[],o=0;for(let c=0,a=n.length;c<a;c+=1){const l=n[c];i.length=0,t=0;for(let F=0,E=l.length;F<E;F+=1){const d=l[F],{isMatch:m,indices:h,score:p}=d.search(e);if(m){if(t+=1,o+=p,s){const A=d.constructor.type;ct.has(A)?i=[...i,...h]:i.push(h)}}else{o=0,t=0,i.length=0;break}}if(t){let F={isMatch:!0,score:o/t};return s&&(F.indices=i),F}}return{isMatch:!1,score:1}}}const lu=[];function lt(...u){lu.push(...u)}function Fu(u,e){for(let n=0,s=lu.length;n<s;n+=1){let D=lu[n];if(D.condition(u,e))return new D(u,e)}return new ie(u,e)}const uu={AND:"$and",OR:"$or"},hu={PATH:"$path",PATTERN:"$val"},Cu=u=>!!(u[uu.AND]||u[uu.OR]),Ft=u=>!!u[hu.PATH],ht=u=>!M(u)&&De(u)&&!Cu(u),ku=u=>({[uu.AND]:Object.keys(u).map(e=>({[e]:u[e]}))});function ae(u,e,{auto:n=!0}={}){const s=D=>{let r=Object.keys(D);const t=Ft(D);if(!t&&r.length>1&&!Cu(D))return s(ku(D));if(ht(D)){const o=t?D[hu.PATH]:r[0],c=t?D[hu.PATTERN]:D[o];if(!y(c))throw new Error($e(o));const a={keyId:cu(o),pattern:c};return n&&(a.searcher=Fu(c,e)),a}let i={children:[],operator:r[0]};return r.forEach(o=>{const c=D[o];M(c)&&c.forEach(a=>{i.children.push(s(a))})}),i};return Cu(u)||(u=ku(u)),s(u)}function Ct(u,{ignoreFieldNorm:e=C.ignoreFieldNorm}){u.forEach(n=>{let s=1;n.matches.forEach(({key:D,norm:r,score:t})=>{const i=D?D.weight:null;s*=Math.pow(t===0&&i?Number.EPSILON:t,(i||1)*(e?1:r))}),n.score=s})}function Et(u,e){const n=u.matches;e.matches=[],B(n)&&n.forEach(s=>{if(!B(s.indices)||!s.indices.length)return;const{indices:D,value:r}=s;let t={indices:D,value:r};s.key&&(t.key=s.key.src),s.idx>-1&&(t.refIndex=s.idx),e.matches.push(t)})}function dt(u,e){e.score=u.score}function ft(u,e,{includeMatches:n=C.includeMatches,includeScore:s=C.includeScore}={}){const D=[];return n&&D.push(Et),s&&D.push(dt),u.map(r=>{const{idx:t}=r,i={item:e[t],refIndex:t};return D.length&&D.forEach(o=>{o(r,i)}),i})}class ${constructor(e,n={},s){this.options={...C,...n},this.options.useExtendedSearch,this._keyStore=new We(this.options.keys),this.setCollection(e,s)}setCollection(e,n){if(this._docs=e,n&&!(n instanceof mu))throw new Error(Pe);this._myIndex=n||se(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){B(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const n=[];for(let s=0,D=this._docs.length;s<D;s+=1){const r=this._docs[s];e(r,s)&&(this.removeAt(s),s-=1,D-=1,n.push(r))}return n}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:n=-1}={}){const{includeMatches:s,includeScore:D,shouldSort:r,sortFn:t,ignoreFieldNorm:i}=this.options;let o=y(e)?y(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Ct(o,{ignoreFieldNorm:i}),r&&o.sort(t),te(n)&&n>-1&&(o=o.slice(0,n)),ft(o,this._docs,{includeMatches:s,includeScore:D})}_searchStringList(e){const n=Fu(e,this.options),{records:s}=this._myIndex,D=[];return s.forEach(({v:r,i:t,n:i})=>{if(!B(r))return;const{isMatch:o,score:c,indices:a}=n.searchIn(r);o&&D.push({item:r,idx:t,matches:[{score:c,value:r,norm:i,indices:a}]})}),D}_searchLogical(e){const n=ae(e,this.options),s=(i,o,c)=>{if(!i.children){const{keyId:l,searcher:F}=i,E=this._findMatches({key:this._keyStore.get(l),value:this._myIndex.getValueForItemAtKeyId(o,l),searcher:F});return E&&E.length?[{idx:c,item:o,matches:E}]:[]}const a=[];for(let l=0,F=i.children.length;l<F;l+=1){const E=i.children[l],d=s(E,o,c);if(d.length)a.push(...d);else if(i.operator===uu.AND)return[]}return a},D=this._myIndex.records,r={},t=[];return D.forEach(({$:i,i:o})=>{if(B(i)){let c=s(n,i,o);c.length&&(r[o]||(r[o]={idx:o,item:i,matches:[]},t.push(r[o])),c.forEach(({matches:a})=>{r[o].matches.push(...a)}))}}),t}_searchObjectList(e){const n=Fu(e,this.options),{keys:s,records:D}=this._myIndex,r=[];return D.forEach(({$:t,i})=>{if(!B(t))return;let o=[];s.forEach((c,a)=>{o.push(...this._findMatches({key:c,value:t[a],searcher:n}))}),o.length&&r.push({idx:i,item:t,matches:o})}),r}_findMatches({key:e,value:n,searcher:s}){if(!B(n))return[];let D=[];if(M(n))n.forEach(({v:r,i:t,n:i})=>{if(!B(r))return;const{isMatch:o,score:c,indices:a}=s.searchIn(r);o&&D.push({score:c,key:e,value:r,idx:t,norm:i,indices:a})});else{const{v:r,n:t}=n,{isMatch:i,score:o,indices:c}=s.searchIn(r);i&&D.push({score:o,key:e,value:r,norm:t,indices:c})}return D}}$.version="7.1.0";$.createIndex=se;$.parseIndex=Xe;$.config=C;$.parseQuery=ae;lt(at);const{Textcomplete:mt}=Zu||ye,{ContenteditableEditor:gt}=ee||Oe;let le,Eu,Fe;const pt=u=>{let e=u.split(":").join("");if(g.get("useEmoteFuzzyMatching"))return le.search(e);e=e.toLowerCase();const n=[];for(const s of Eu)s.name.toLowerCase().includes(e)&&n.push({item:s});return n},At={id:"emote",match:/\B:([-+\w]*)$/,index:1,search:async(u,e,n)=>{e(pt(u))},cache:!1,template:u=>`<img src="${u.item.url}?accessKey=${g.get("accessKey")}">&nbsp;<small>${u.item.name}</small>`,replace:u=>`:${u.item.name}: `},Bt=async(u,e=!1)=>{if(u.dataset.handlingEmoteSuggestions)return;u.dataset.handlingEmoteSuggestions=!0,e&&(u.dataset.requiresManualDeletions=!0);const n=new mt(new gt(u),[At],Fe);new window.MutationObserver((s,D)=>{document.body.contains(u)||(n.destroy(),D.disconnect())}).observe(document.body,{childList:!0,subtree:!0})},he=u=>{if(u.nodeType!==window.Node.ELEMENT_NODE)return;const e=[{class:"mx_BasicMessageComposer_input",requiresManualDeletions:!1},{class:"mx_WysiwygComposer_Editor_content",requiresManualDeletions:!0}];if(u.classList){for(const n of e)if(u.classList.contains(n.class)){Bt(u,n.requiresManualDeletions);return}}u.childNodes&&[...u.childNodes].forEach(he)},vt={initialize:()=>{const u=g.get("emoteSuggestionBlacklistedStrings").split("|").map(e=>e.trim().toLowerCase()).filter(e=>e!=="");Eu=g.get("emotes").filter(e=>{const n=e.name.toLowerCase();for(const s of u)if(n.includes(s))return!1;return!0}),g.get("useEmoteFuzzyMatching")&&(le=new $(Eu,{keys:["name"],location:g.get("emoteFuzzyMatchingLocation"),distance:g.get("emoteFuzzyMatchingDistance"),threshold:g.get("emoteFuzzyMatchingThreshold")})),Fe={dropdown:{className:"dropdown-menu textcomplete-dropdown mx_Autocomplete",maxCount:g.get("emoteSuggestionAmount"),placement:"top",header:()=>"",footer:()=>"",rotate:!0,style:{display:"none",position:"absolute",zIndex:"1000"},parent:document.body,item:{className:"textcomplete-item mx_Autocomplete_Completion_pill",activeClassName:"textcomplete-item active mx_Autocomplete_Completion_pill mx_Autocomplete_Completion selected"}}},new window.MutationObserver(e=>{for(const n of e)for(const s of n.addedNodes)he(s)}).observe(document.body,{childList:!0,subtree:!0})}};/*!
 * element-emotes
 * Copyright (C) 2022-present  Michael Serajnik  https://github.com/mserajnik
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */const _t=["var(--cpd-color-blue-1200)","var(--cpd-color-fuchsia-1200)","var(--cpd-color-green-1200)","var(--cpd-color-pink-1200)","var(--cpd-color-orange-1200)","var(--cpd-color-cyan-1200)","var(--cpd-color-purple-1200)","var(--cpd-color-lime-1200)"],Y=[],yt={initialize:()=>{const u=g.get("usernameColors");for(let s=0;s<8;s++){if(u[s]!==""&&u[s]!==_t[s]){Y.push(u[s]);continue}Y.push(null)}if(!Y.some(s=>s!==null))return;const n=document.createElement("style");for(const[s,D]of Y.entries())D&&(n.innerHTML+=`
        .mx_Username_color${s+1} {
          color: ${D} !important;
        }
      `);document.head.appendChild(n)}};/*!
 * element-emotes
 * Copyright (C) 2022-present  Michael Serajnik  https://github.com/mserajnik
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */(async()=>{try{await g.initialize()}catch(u){window.alert(u);return}Be.initialize(),vt.initialize(),yt.initialize()})();
